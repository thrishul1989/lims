<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="renderer" content="webkit">
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>基因管理</title>
<!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->
<link href="${system_css}/bootstrap.min14ed.css?v=3.3.6"
	rel="stylesheet">
<link href="${system_css}/font-awesome.min93e3.css?v=4.4.0"
	rel="stylesheet">
<link href="${system_css}/animate.min.css" rel="stylesheet">
<link href="${system_css}/style.min862f.css?v=4.1.0" rel="stylesheet">
<link href="${system_css}/lims.css?v=4.1.0" rel="stylesheet">
<link href="${system_css}/bootstrap-select.min.css" rel="stylesheet">
<link href="${system_css}/magicsuggest-min.css" rel="stylesheet">
<link href="${system_js}/bootstrap-fileinput-master/css/fileinput.css" rel="stylesheet">


<script type="text/javascript" src="${system_js}/jquery.min.js?v=2.1.4"></script>
<script type="text/javascript" src="${system_js}/bootstrap.min.js"></script>
<script type="text/javascript" src="${system_js}/system.js"></script>
<script src="${system_js}/bootstrap-suggest.js"></script>
<script src="${plugins}/pagination/jquery.pagination.js"></script>
<!-- 表单验证 -->

<script src="${system_js}/bootstrap-fileinput-master/js/fileinput.js"></script>
<script src="${system_js}/bootstrap-fileinput-master/js/zh.js"></script>

<script>
	function showUploadModal(id){
		$('#uploadModal').modal('show');
	}
	

</script>


</head>
<body class="gray-bg" >
    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-lg-12">
            <div class="ibox">
                    <div class="ibox-title" style="border-color: white">
                        <ol class="breadcrumb">
                            <li>
                                <a href="${base}/disease/genelist.do">导入基因</a>
                            </li>
                            <li class="active">
                                <strong>导入基因列表</strong>
                            </li>
                            
                           
                        </ol>
                    </div>
                </div>
               
                <div class="ibox ibox-table">
                   <div class="ibox-title">
                        <h5>基因列表</h5>
                        <span style="float: right">
                        <ul style=list-style:none;margin:0;>
                        <li style="display:inline;margin-right: 12px">
                        <div style="width: 30px;height: 10px;background-color: #f58585;display: inline-block;"></div>错误数据</li>
                        <li style="display:inline" >
                        <div style="width: 30px;height: 10px;background-color: #e3f190;display: inline-block;"></div>已存在，覆盖原数据</li>
                        </ul>
                        </span>
                    </div>
                    <div class="ibox-content" style=" zoom: 1;min-height: 350px;overflow: scroll;">
                        <div class="col-sm-12">
                        <table class="table table-striped table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th class="index">序号</th>
                                    <th>基因OMIM号</th>
                                    <th>基因名称</th>
                                    <th>基因全名</th>
                                    <th>Uniport ID</th>
                                    <th>外显子数</th>
                                    <th>内含子数</th>
                                    <th>nm号</th>
                                    <th>染色体区域</th>
                                    <th class="col-md-1">基因别名</th>
                                    <th>Missense nonsense</th>
                                    <th>Splicing</th>
                                    <th>Regulatory</th>
                                    <th>Small deletions</th>
                                    <th>Small insertions</th>
                                    <th>Small indels</th>
                                    <th>Gross deletions</th>
                                    <th>Gross insertionsduplications</th>
                                    <th>Complex rearrangements</th>
                                    <th>Repeat variations</th>
                                    
                                  <th class="flexible-btns">操作</th>
                                </tr>
                            </thead>
                            <tbody>
                            <#if geneList??>
                              <#if geneList?has_content> 
                              <#list geneList as record>
                              
                              <#if record.code != "">
                              <#if record.isOverwrite!?html == "1">
                              <tr style="background-color: #e3f190" class="datatr">
                              <#else>
                              <tr class="datatr">
                              </#if>
                              <#else>
                               <tr style="background-color: #f58585" class="datatr">
                              </#if>
                                   <td >${record_index + 1}</td>
                                   <td name="code">${record.code!?html}</td>
                                   <td name="symbol">${record.symbol!?html}</td>
                                    <td name="name">${record.name!?html}</td>
                                   <td name="uniportId">${record.uniportId!?html}</td>
                                   <td name="exonCount">${record.exonCount!?html}</td>
                                   <td name="intronCount">${record.intronCount!?html}</td>
                                   <td name="exomeNo">${record.exomeNo!?html}</td>
                                   <td name="chromosomalLocation">${record.chromosomalLocation!?html}</td>
                                   <td class="col-md-1" name="importAlias">${record.importAlias!?html}</td>
                                   <td name="missenseNonsense">${record.missenseNonsense!?html}</td>
                                   <td name="splicing">${record.splicing!?html}</td>
                                   <td name="regulatory">${record.regulatory!?html}</td>
                                   <td name="smallDeletions">${record.smallDeletions!?html}</td>
                                   <td name="smallInsertions">${record.smallInsertions!?html}</td>
                                   <td name="smallIndels">${record.smallIndels!?html}</td>
                                   <td name="grossDeletions">${record.grossDeletions!?html}</td>
                                   <td name="grossInsertionsDuplications">${record.grossInsertionsDuplications!?html}</td>
                                   <td name="complexRearrangements">${record.complexRearrangements!?html}</td>
                                   <td name="repeatVariations">${record.repeatVariations!?html}</td>                     
                                   
 								   <td class="flexible-btns-3">
                                      <a class="btn btn-sm btn-success layer-confirm"  
                                         onclick="deleteTd(this)">
                                            <i class="fa fa-trash"></i> 删除
                                      </a>
                                  </td>
                                 </tr>
                                 </#list>
                                </#if>
                                </#if>
                            </tbody>
                            </table>
                
					<div >
						<button type="button" class="btn btn-primary" onclick="saveGene()">提交</button>
						<button class="btn btn-primary goback" type="button" data-url="${base}/disease/genelist.do" >返回</button>
					</div>
				
			
                        </div>
                    </div>
                </div><!-- ibox-table -->
                
            </div>
        </div>
    </div> 
	
     
</body>

<script>
function deleteTd(obj){
	$(obj).parent().parent().remove()
}

//提交gene
function saveGene(){
	var geneList=[];
	$.each($('.datatr'),function(index,obj){
		var data={code:$(obj).find('td[name="code"]').html(),
				  symbol:$(obj).find('td[name="symbol"]').html(),
				  name:$(obj).find('td[name="name"]').html(),
				  uniportId:$(obj).find('td[name="uniportId"]').html(),
				  exonCount:$(obj).find('td[name="exonCount"]').html(),
				  intronCount:$(obj).find('td[name="intronCount"]').html(),
				  exomeNo:$(obj).find('td[name="exomeNo"]').html(),
				  chromosomalLocation:$(obj).find('td[name="chromosomalLocation"]').html(),
				  importAlias:$(obj).find('td[name="importAlias"]').html(),
				  missenseNonsense:$(obj).find('td[name="missenseNonsense"]').html(),
				  splicing:$(obj).find('td[name="splicing"]').html(),
				  regulatory:$(obj).find('td[name="regulatory"]').html(),
				  smallDeletions:$(obj).find('td[name="smallDeletions"]').html(),
				  smallInsertions:$(obj).find('td[name="smallInsertions"]').html(),
				  smallIndels:$(obj).find('td[name="smallIndels"]').html(),
				  grossDeletions:$(obj).find('td[name="grossDeletions"]').html(),
				  grossInsertionsDuplications:$(obj).find('td[name="grossInsertionsDuplications"]').html(),
				  complexRearrangements:$(obj).find('td[name="complexRearrangements"]').html(),
				  repeatVariations:$(obj).find('td[name="repeatVariations"]').html()}
		
		geneList.push(data);
	});
	
	console.info(JSON.stringify(geneList));
	var layerObject = parent.parent.layer;
	var loadindex = layerObject.load();
	$.ajax({
        type: "POST",
        url: "${base}/disease/uploadGeneData.do",
        data: {geneList:JSON.stringify(geneList)},
        dataType: "text",
        success: function(data){
        	window.location.href="${base}/disease/genelist.do";
        	layerObject.close(loadindex);
     	},
        error:function(){
        	layerObject.close(loadindex);
        }
    });
	
	

}
</script>
    
</html>

